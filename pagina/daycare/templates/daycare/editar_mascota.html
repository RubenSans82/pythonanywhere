{# pagina/daycare/templates/daycare/editar_mascota.html #}
{% extends 'daycare/base.html' %}
{% load static %} {# Si usas {% static %} para placeholders de imagen u otra cosa #}

{% block title %}Editar {{ mascota.nombre }}{% endblock %}

{% block content %}
    <p><a href="{% url 'daycare:detalle_mascota' mascota.pk %}" class="btn btn-outline-secondary btn-sm mb-3">← Volver a Detalles de {{ mascota.nombre }}</a></p>

    <h1 class="mb-4">Editar Datos de {{ mascota.nombre }}</h1>

    {# Formulario para editar. Método POST, permite subida de archivos #}
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        {# Si quieres mostrar la foto actual #}
        {% if mascota.foto %}
            <div class="mb-3">
                <strong>Foto Actual:</strong><br>
                <img src="{{ mascota.foto.url }}" alt="Foto actual de {{ mascota.nombre }}" style="max-width: 200px; height: auto; margin-top: 5px;">
            </div>
        {% endif %}


        {# Renderizar cada campo individualmente (similar a agregar_mascota.html) #}

        {# Campo Nombre #}
        <div class="mb-3">
            <label for="{{ form.nombre.id_for_label }}" class="form-label">Nombre de la Mascota:</label>
            {{ form.nombre }}
            {% if form.nombre.help_text %}<div class="form-text">{{ form.nombre.help_text|safe }}</div>{% endif %}
            {% for error in form.nombre.errors %}<div class="text-danger">{{ error }}</div>{% endfor %}
        </div>

        {# Campo Raza #}
        <div class="mb-3">
            <label for="{{ form.raza.id_for_label }}" class="form-label">Raza:</label>
            {{ form.raza }}
            {% if form.raza.help_text %}<div class="form-text">{{ form.raza.help_text|safe }}</div>{% endif %}
            {% for error in form.raza.errors %}<div class="text-danger">{{ error }}</div>{% endfor %}
        </div>

        {# Campo Fecha de Nacimiento #}
         <div class="mb-3">
            <label for="{{ form.fecha_nacimiento.id_for_label }}" class="form-label">Fecha de Nacimiento:</label>
            {{ form.fecha_nacimiento }}
            {% if form.fecha_nacimiento.help_text %}<div class="form-text">{{ form.fecha_nacimiento.help_text|safe }}</div>{% endif %}
            {% for error in form.fecha_nacimiento.errors %}<div class="text-danger">{{ error }}</div>{% endfor %}
        </div>

        {# Campo Notas Médicas #}
        <div class="mb-3">
            <label for="{{ form.notas_medicas.id_for_label }}" class="form-label">Notas Médicas:</label>
            {{ form.notas_medicas }}
            {% if form.notas_medicas.help_text %}<div class="form-text">{{ form.notas_medicas.help_text|safe }}</div>{% endif %}
            {% for error in form.notas_medicas.errors %}<div class="text-danger">{{ error }}</div>{% endfor %}
        </div>

        {# Campo Notas Comportamiento #}
         <div class="mb-3">
            <label for="{{ form.comportamiento_notas.id_for_label }}" class="form-label">Notas de Comportamiento:</label>
            {{ form.comportamiento_notas }}
            {% if form.comportamiento_notas.help_text %}<div class="form-text">{{ form.comportamiento_notas.help_text|safe }}</div>{% endif %}
            {% for error in form.comportamiento_notas.errors %}<div class="text-danger">{{ error }}</div>{% endfor %}
        </div>


        {# Campo Foto - ¡Importante! Permite cambiar o borrar la foto existente #}
        {# Django genera automáticamente el input type="file" con la info de la foto actual #}
        <div class="mb-3">
            <label for="{{ form.foto.id_for_label }}" class="form-label">Cambiar Foto:</label>
            {{ form.foto }}
            {% if form.foto.help_text %}
                <div class="form-text">{{ form.foto.help_text|safe }}</div>
            {% endif %}
            {% for error in form.foto.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>


        {# Errores no asociados a un campo específico #}
        {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}


        <button type="submit" class="btn btn-primary mt-3">Guardar Cambios</button>
    </form>

{% endblock content %}